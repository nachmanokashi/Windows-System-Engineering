# server/scripts/add_articles.py
"""
×¡×§×¨×™×¤×˜ ×œ×”×•×¡×¤×ª ××××¨×™× ×œ××¢×¨×›×ª
××¤×©×¨×•×™×•×ª:
1. ×”×•×¡×¤×” ×™×“× ×™×ª ×©×œ ××××¨×™×
2. ×©×œ×™×¤×” ××•×˜×•××˜×™×ª ×-News API
3. ×™×¦×™×¨×ª ××××¨×™× ×“××” ×œ×‘×“×™×§×•×ª
"""

import sys
import os
from datetime import datetime, timedelta
import random

# ×”×•×¡×£ ××ª ×ª×™×§×™×™×ª ×”-server ×œ-path
sys.path.insert(0, os.path.abspath(os.path.join(os.path.dirname(__file__), '..')))

from sqlalchemy.orm import Session
from app.core.db import SessionLocal
from app.mvc.models.articles.article_entity import Article


# ============================================
# ××××¨×™× ×œ×“×•×’××” ×‘×ª×—×•××™× ×©×•× ×™×
# ============================================

SAMPLE_ARTICLES = [
    {
        "title": "×¤×¨×™×¦×ª ×“×¨×š ×‘×˜×›× ×•×œ×•×’×™×™×ª AI: ××•×“×œ ×—×“×© ××‘×™×Ÿ ×”×§×©×¨ ×›××• ×‘× ×™ ××“×",
        "summary": "×—×•×§×¨×™× ×¤×™×ª×—×• ××•×“×œ ×‘×™× ×” ××œ××›×•×ª×™×ª ×—×“×© ×©××¡×•×’×œ ×œ×”×‘×™×Ÿ ×”×§×©×¨ ×•×¨×’×©×•×ª ×‘×©×™×—×•×ª ×›××¢×˜ ×›××• ×‘× ×™ ××“×",
        "content": """
        ×‘××¢×‘×“×•×ª ×”××—×§×¨ ×©×œ ××•× ×™×‘×¨×¡×™×˜×ª ×¡×˜× ×¤×•×¨×“ ×¤×•×ª×— ××•×“×œ AI ×—×“×©× ×™ ×©××¡×•×’×œ ×œ×”×‘×™×Ÿ ×”×§×©×¨ ×¨×’×©×™ ×‘×©×™×—×•×ª.
        ×”××•×“×œ, ×©× ×§×¨× "ContextPro", ××©×ª××© ×‘××¨×›×™×˜×§×˜×•×¨×ª Transformer ××©×•×¤×¨×ª ×”×××¤×©×¨×ª ×œ×• ×œ×–×”×•×ª 
        ×’×•×•× ×™× ×¨×’×©×™×™× ×¢×“×™× ×™× ×‘×˜×§×¡×˜ ×•×“×™×‘×•×¨.
        
        ×”××•×“×œ ×¢×‘×¨ ××™××•×Ÿ ×¢×œ ××™×œ×™×•× ×™ ×©×™×—×•×ª ×× ×•×©×™×•×ª ×•××¡×•×’×œ ×›×¢×ª ×œ×–×”×•×ª:
        - ×¡×¨×§×–× ×•××™×¨×•× ×™×”
        - ×¨×’×©×•×ª × ×¡×ª×¨×™×
        - ×›×•×•× ×•×ª ××¨×•××–×•×ª
        - ×”×§×©×¨ ×ª×¨×‘×•×ª×™
        
        ×”×—×•×§×¨×™× ××“×•×•×—×™× ×¢×œ ×“×™×•×§ ×©×œ 94% ×‘×–×™×”×•×™ ×¨×’×©×•×ª, ×œ×¢×•××ª 87% ×‘××•×“×œ×™× ×§×•×“××™×.
        ×”×˜×›× ×•×œ×•×’×™×” ×¢×©×•×™×” ×œ×©× ×•×ª ××ª ×ª×—×•× ×©×™×¨×•×ª ×”×œ×§×•×—×•×ª, ×˜×™×¤×•×œ × ×¤×©×™ ×“×™×’×™×˜×œ×™, ×•×××©×§×™ ×©×™×—×”.
        """,
        "url": "https://example.com/ai-breakthrough",
        "source": "Tech News",
        "category": "Technology",
        "image_url": "https://images.unsplash.com/photo-1677442136019-21780ecad995?w=800",
        "thumb_url": "https://images.unsplash.com/photo-1677442136019-21780ecad995?w=400"
    },
    {
        "title": "××—×§×¨ ×—×“×©: ×ª×–×•× ×” ×™×-×ª×™×›×•× ×™×ª ××¤×—×™×ª×” ×¡×™×›×•×Ÿ ×œ××—×œ×•×ª ×œ×‘ ×‘-40%",
        "summary": "××—×§×¨ ×¢× ×§ ×©× ×¢×¨×š ×¢×œ 10,000 ××©×ª×ª×¤×™× ××¦× ×§×©×¨ ×‘×¨×•×¨ ×‘×™×Ÿ ×ª×–×•× ×” ×™×-×ª×™×›×•× ×™×ª ×œ×‘×¨×™××•×ª ×”×œ×‘",
        "content": """
        ××—×§×¨ ×—×“×© ×©×¤×•×¨×¡× ×‘×›×ª×‘ ×”×¢×ª JAMA ×”×¨×¤×•××™ ××’×œ×” ×›×™ ×ª×–×•× ×” ×™×-×ª×™×›×•× ×™×ª ××¤×—×™×ª×” ×‘××•×¤×Ÿ 
        ××©××¢×•×ª×™ ××ª ×”×¡×™×›×•×Ÿ ×œ××—×œ×•×ª ×œ×‘ ×•×›×œ×™ ×“×.
        
        ×”××—×§×¨, ×©× ××©×š 12 ×©× ×™× ×•×¢×§×‘ ××—×¨ 10,000 ××©×ª×ª×¤×™× ×-23 ××“×™× ×•×ª, ××¦× ×›×™:
        
        - ×™×¨×™×“×” ×©×œ 40% ×‘×¡×™×›×•×Ÿ ×œ××•×˜× ×©×¨×™×¨ ×”×œ×‘
        - ×™×¨×™×“×” ×©×œ 35% ×‘×¡×™×›×•×Ÿ ×œ×©×‘×¥ ××•×—×™
        - ×©×™×¤×•×¨ ×‘×¨××•×ª ×”×›×•×œ×¡×˜×¨×•×œ ×‘-28%
        - ×”×¤×—×ª×ª ×œ×—×¥ ×“× ×‘-15%
        
        ×¢×§×¨×•× ×•×ª ×”×ª×–×•× ×” ×›×•×œ×œ×™×:
        â€¢ ×©××Ÿ ×–×™×ª ×›×©×•××Ÿ ×¢×™×§×¨×™
        â€¢ ×“×’×™× 2-3 ×¤×¢××™× ×‘×©×‘×•×¢
        â€¢ ×™×¨×§×•×ª ×•×¤×™×¨×•×ª ×˜×¨×™×™×
        â€¢ ×§×˜× ×™×•×ª ×•×“×’× ×™× ××œ××™×
        â€¢ ××¢×˜ ×‘×©×¨ ××“×•×
        
        ×”×—×•×§×¨×™× ×××œ×™×¦×™× ×œ×××¥ ××ª ×”×ª×–×•× ×” ×‘×”×“×¨×’×” ×œ×ª×•×¦××•×ª ××™×˜×‘×™×•×ª.
        """,
        "url": "https://example.com/mediterranean-diet",
        "source": "Health Magazine",
        "category": "Health",
        "image_url": "https://images.unsplash.com/photo-1505253758473-96b7015fcd40?w=800",
        "thumb_url": "https://images.unsplash.com/photo-1505253758473-96b7015fcd40?w=400"
    },
    {
        "title": "SpaceX ××©×™×§×” ×˜×œ×¡×§×•×¤ ×—×œ×œ ×—×“×© ×œ×—×™×¤×•×© ×—×™×™× ××—×•×¥ ×œ×›×“×•×¨ ×”××¨×¥",
        "summary": "×˜×œ×¡×§×•×¤ ExoLife ×”×—×“×© ×™×©×•×’×¨ ×”×©×‘×•×¢ ×•×™×¡×¨×•×§ ×›×•×›×‘×™ ×œ×›×ª ××¨×•×—×§×™× ×œ×—×™×¤×•×© ×¡×™×× ×™ ×—×™×™×",
        "content": """
        SpaceX ××ª×›×•× × ×ª ×œ×©×’×¨ ××ª ×˜×œ×¡×§×•×¤ ×”×—×œ×œ ExoLife, ×”×˜×œ×¡×§×•×¤ ×”××ª×§×“× ×‘×™×•×ª×¨ ×©× ×‘× ×” ××™ ×¤×¢× 
        ×œ×—×™×¤×•×© ×—×™×™× ××—×•×¥ ×œ×›×“×•×¨ ×”××¨×¥.
        
        ×™×›×•×œ×•×ª ×”×˜×œ×¡×§×•×¤:
        - × ×™×ª×•×— ×¡×¤×§×˜×¨×•×¡×§×•×¤×™ ×©×œ ××˜××•×¡×¤×¨×•×ª ×›×•×›×‘×™ ×œ×›×ª
        - ×–×™×”×•×™ ××•×œ×§×•×œ×•×ª ××•×¨×’× ×™×•×ª ××¨×—×•×§ ×©×œ ××™×œ×™×•× ×™ ×©× ×•×ª ××•×¨
        - ××¢×§×‘ ××—×¨ 10,000 ×›×•×›×‘×™ ×œ×›×ª ×‘××§×‘×™×œ
        - ×¨×’×™×©×•×ª ×¤×™ 100 ××˜×œ×¡×§×•×¤ ×’'×™×™××¡ ×•×•×‘
        
        ×”××“×¢× ×™× ×™×—×¤×©×• "×‘×™×•-×¡×™×’× ×˜×•×¨×•×ª" ×›××•:
        â€¢ ×—××¦×Ÿ ×•×—× ×§×Ÿ ×‘××˜××•×¡×¤×¨×”
        â€¢ ××ª××Ÿ ×‘×™×•×œ×•×’×™
        â€¢ ×›×œ×•×¨×•×¤×™×œ ××¦××—×™×™×”
        â€¢ ××•×ª×•×ª ×¨×“×™×• ××œ××›×•×ª×™×™×
        
        ×”×©×™×’×•×¨ ××ª×•×›× ×Ÿ ×œ×©×‘×•×¢ ×”×‘× ×•×ª×•×¦××•×ª ×¨××©×•× ×•×ª ×¦×¤×•×™×•×ª ×ª×•×š 6 ×—×•×“×©×™×.
        ×¤×¨×•×™×§×˜ ×–×” ×¢×©×•×™ ×œ×¢× ×•×ª ×¢×œ ×”×©××œ×” ×”×¢×ª×™×§×”: ×”×× ×× ×—× ×• ×œ×‘×“ ×‘×™×§×•×?
        """,
        "url": "https://example.com/exolife-telescope",
        "source": "Space Daily",
        "category": "Science",
        "image_url": "https://images.unsplash.com/photo-1446776653964-20c1d3a81b06?w=800",
        "thumb_url": "https://images.unsplash.com/photo-1446776653964-20c1d3a81b06?w=400"
    },
    {
        "title": "×”××”×¤×›×” ×”×™×¨×•×§×”: ×™×©×¨××œ ××•×‘×™×œ×” ×‘×˜×›× ×•×œ×•×’×™×•×ª ×× ×¨×’×™×” ××ª×—×“×©×ª",
        "summary": "×¡×˜××¨×˜-××¤×™× ×™×©×¨××œ×™× ××¤×ª×—×™× ×˜×›× ×•×œ×•×’×™×•×ª ×¤×•×¨×¦×•×ª ×“×¨×š ×‘×× ×¨×’×™×” ×¡×•×œ××¨×™×ª ×•××—×¡×•×Ÿ ×× ×¨×’×™×”",
        "content": """
        ×™×©×¨××œ ×××©×™×›×” ×œ×”×•×‘×™×œ ××ª ×”××”×¤×›×” ×”×™×¨×•×§×” ×¢× ×¤×¨×™×¦×•×ª ×“×¨×š ×‘×ª×—×•× ×”×× ×¨×’×™×” ×”××ª×—×“×©×ª.
        
        ×—×™×“×•×©×™× ××¨×›×–×™×™×:
        
        **×¤×× ×œ×™× ×¡×•×œ××¨×™×™× ×“×•-×¦×“×“×™×™×:**
        ×—×‘×¨×ª SolarEdge ×¤×™×ª×—×” ×¤×× ×œ×™× ×©×¡×•×¤×’×™× ××•×¨ ××©× ×™ ×”×¦×“×“×™×, ××” ×©××’×“×™×œ ××ª ×”×™×¢×™×œ×•×ª ×‘-35%.
        
        **×¡×•×œ×œ×•×ª × ×•×–×œ×™×•×ª:**
        ×¡×˜××¨×˜-××¤ ×™×©×¨××œ×™ ×¤×™×ª×— ×¡×•×œ×œ×•×ª flow battery ×©×™×›×•×œ×•×ª ×œ××—×¡×Ÿ ×× ×¨×’×™×” ×œ×©×‘×•×¢×•×ª ×©×œ××™×.
        
        **AI ×œ× ×™×”×•×œ ×¨×©×ª:**
        ××¢×¨×›×ª ×—×›××” ×©×× ×‘××ª ×¦×¨×™×›×ª ×—×©××œ ×•××™×™×¢×œ×ª ××ª ×”×¤×¦×ª ×”×× ×¨×’×™×” ×‘×–××Ÿ ×××ª.
        
        ×”×©×¤×¢×” ×›×œ×›×œ×™×ª:
        â€¢ ×—×™×¡×›×•×Ÿ ×©×œ 2 ××™×œ×™××¨×“ ×©"×— ×œ×©× ×”
        â€¢ ×™×¦×™×¨×ª 15,000 ××§×•××•×ª ×¢×‘×•×“×”
        â€¢ ×”×¤×—×ª×ª ×¤×œ×™×˜×•×ª CO2 ×‘-25%
        
        ×”××˜×¨×”: 100% ×× ×¨×’×™×” ××ª×—×“×©×ª ×¢×“ 2040.
        """,
        "url": "https://example.com/green-tech-israel",
        "source": "Innovation Daily",
        "category": "Environment",
        "image_url": "https://images.unsplash.com/photo-1509391366360-2e959784a276?w=800",
        "thumb_url": "https://images.unsplash.com/photo-1509391366360-2e959784a276?w=400"
    },
    {
        "title": "×”××§×“××™×” ×”××œ×›×•×ª×™×ª ×œ×›×“×•×¨×’×œ: ×›×š ×××× ×™× ××ª ×›×•×›×‘×™ ×”×¢×ª×™×“",
        "summary": "××‘×˜ ×××—×•×¨×™ ×”×§×œ×¢×™× ×œ××§×“××™×” ×”×™×•×§×¨×ª×™×ª ×©××’×“×œ×ª ××ª ×©×—×§× ×™ ×”×›×“×•×¨×’×œ ×”××•×‘×™×œ×™× ×‘×¢×•×œ×",
        "content": """
        ×”××§×“××™×” ×”××œ×›×•×ª×™×ª ×©×œ ×¨×™××œ ××“×¨×™×“ × ×—×©×‘×ª ×œ×˜×•×‘×” ×‘×¢×•×œ× ×‘×”×›×©×¨×ª ×›×“×•×¨×’×œ× ×™× ×¦×¢×™×¨×™×.
        
        ×ª×•×›× ×™×ª ×”××™××•× ×™× ×›×•×œ×œ×ª:
        
        **××™××•× ×™ ×›×“×•×¨×’×œ ××ª×§×“××™×:**
        - 6 ×™××™× ×‘×©×‘×•×¢, 3 ×©×¢×•×ª ×œ×™×•×
        - ×“×’×© ×¢×œ ×˜×›× ×™×§×” ××™×©×™×ª
        - ××©×—×§ ×§×‘×•×¦×ª×™ ×•××¡×˜×¨×˜×’×™×”
        
        **×¤×™×ª×•×— ×’×•×¤× ×™:**
        - ××™××•× ×™ ×›×•×— ×•×¡×™×‘×•×œ×ª
        - ×ª×–×•× ×” ××“×¢×™×ª ××•×ª×××ª ××™×©×™×ª
        - ××¢×§×‘ ×¨×¤×•××™ ×©×•×˜×£
        
        **×¤×™×ª×•×— ×× ×˜×œ×™:**
        - ×¢×‘×•×“×” ×¢× ×¤×¡×™×›×•×œ×•×’×™× ×¡×¤×•×¨×˜
        - × ×™×”×•×œ ×œ×—×¥ ×•×”×ª××•×“×“×•×ª ×¢× ×›×™×©×œ×•×Ÿ
        - ×‘× ×™×™×ª ××•×¤×™ ×•×× ×”×™×’×•×ª
        
        **×—×™× ×•×š:**
        - ×œ×™××•×“×™× ××œ××™× ×‘××§×‘×™×œ
        - ×©×¤×•×ª (×× ×’×œ×™×ª + ×¡×¤×¨×“×™×ª)
        - ×”×›× ×” ×œ×§×¨×™×™×¨×” ××—×¨×™ ×”×¡×¤×•×¨×˜
        
        ×¡×˜×˜×™×¡×˜×™×§×” ××¨×©×™××”:
        â€¢ 80% ××”×‘×•×’×¨×™× ××©×—×§×™× ×‘××§×¦×•×¢× ×™
        â€¢ 35 ×‘×•×’×¨×™× ×‘× ×‘×—×¨×•×ª ×œ××•××™×•×ª
        â€¢ 5 ×–×•×›×™ ×’×œ×•×‘×•×¡ ×”×–×”×‘ ×™×¦××• ××”××§×“××™×”
        
        ×”××§×“××™×” ××§×‘×œ×ª ×¨×§ 2% ××”××•×¢××“×™× - ×”×›×™ ×ª×—×¨×•×ª×™ ×‘×¢×•×œ×.
        """,
        "url": "https://example.com/real-madrid-academy",
        "source": "Sports Weekly",
        "category": "Sports",
        "image_url": "https://images.unsplash.com/photo-1579952363873-27f3bade9f55?w=800",
        "thumb_url": "https://images.unsplash.com/photo-1579952363873-27f3bade9f55?w=400"
    },
    {
        "title": "×›×œ×›×œ×ª ×”×”×™×™×˜×§: ×œ××” ×¡×˜××¨×˜-××¤×™× ××¢×‘×™×¨×™× ××©×¨×“×™× ×œ×ª×œ ××‘×™×‘?",
        "summary": "×’×œ ×—×“×© ×©×œ ×—×‘×¨×•×ª ×˜×›× ×•×œ×•×’×™×” ×‘×™× ×œ××•××™×•×ª ×¤×•×ª×— ××©×¨×“×™ ×¤×™×ª×•×— ×‘×™×©×¨××œ",
        "content": """
        ×ª×œ ××‘×™×‘ ×”×•×¤×›×ª ×œ××’× ×˜ ×¢×•×œ××™ ×œ×—×‘×¨×•×ª ×”×™×™×˜×§, ×¢× ×¢×©×¨×•×ª ×—×‘×¨×•×ª ×‘×™× ×œ××•××™×•×ª ×©×¤×•×ª×—×•×ª 
        ××¨×›×–×™ ×¤×™×ª×•×— ×‘×¢×™×¨.
        
        ×”×¡×™×‘×•×ª ×œ××¢×‘×¨:
        
        **×›×™×©×¨×•× ×•×ª ××™×›×•×ª×™×™×:**
        â€¢ ××”× ×“×¡×™× ×¢× ×¨×§×¢ ×¦×‘××™ ×™×™×—×•×“×™ (8200, ×ª×œ×¤×™×•×ª)
        â€¢ ×ª×¨×‘×•×ª ×©×œ innovation ×•×—×©×™×‘×” out-of-the-box
        â€¢ ×©×œ×™×˜×” ×‘-3-4 ×©×¤×•×ª ×ª×›× ×•×ª ×‘×××•×¦×¢
        
        **××§×•×¡×™×¡×˜× ×ª×•××š:**
        â€¢ ×§×™×¨×‘×” ×œ××©×§×™×¢×™ Venture Capital
        â€¢ ×¨×©×ª ×©×œ ×—×‘×¨×•×ª ×¡×˜××¨×˜-××¤ ×œ×©×™×ª×•×¤×™ ×¤×¢×•×œ×”
        â€¢ ××™×¨×•×¢×™ networking ×©×‘×•×¢×™×™×
        
        **×¢×œ×•×™×•×ª ×ª×—×¨×•×˜×™×•×ª:**
        â€¢ ×–×•×œ ×‘-40% ××¡×Ÿ ×¤×¨× ×¡×™×¡×§×•
        â€¢ ×–×•×œ ×‘-25% ××œ×•× ×“×•×Ÿ
        â€¢ ××¢× ×§×™ ×××©×œ×” ×œ×—×‘×¨×•×ª ×–×¨×•×ª
        
        **××™×›×•×ª ×—×™×™×:**
        â€¢ ××§×œ×™× ×™× ×ª×™×›×•× ×™
        â€¢ ×ª×¨×‘×•×ª ×•××•×× ×•×ª ××©×’×©×’×ª
        â€¢ ×§×¨×‘×” ×œ×™× ×•×œ×˜×‘×¢
        
        ×—×‘×¨×•×ª ×©×›×‘×¨ ×›××Ÿ:
        Google, Microsoft, Apple, Amazon, Meta, Nvidia, Intel
        
        ×¦×¤×™: 50 ××œ×£ ××§×•××•×ª ×¢×‘×•×“×” ×—×“×©×™× ×¢×“ 2027.
        """,
        "url": "https://example.com/tel-aviv-tech",
        "source": "Business Today",
        "category": "Business",
        "image_url": "https://images.unsplash.com/photo-1486406146926-c627a92ad1ab?w=800",
        "thumb_url": "https://images.unsplash.com/photo-1486406146926-c627a92ad1ab?w=400"
    }
]


def add_sample_articles(db: Session, days_offset: int = 0):
    """×”×•×¡×£ ××××¨×™× ×œ×“×•×’××” ×œ××¡×“ ×”× ×ª×•× ×™×"""
    added_count = 0
    
    for article_data in SAMPLE_ARTICLES:
        # ×‘×“×•×§ ×× ×”××××¨ ×›×‘×¨ ×§×™×™×
        existing = db.query(Article).filter(Article.url == article_data["url"]).first()
        if existing:
            print(f"âš ï¸  ××××¨ ×›×‘×¨ ×§×™×™×: {article_data['title'][:50]}...")
            continue
        
        # ×¦×•×¨ ×ª××¨×™×š ×¤×¨×¡×•× ××§×¨××™ ×‘×™××™× ×”××—×¨×•× ×™×
        days_ago = random.randint(0, days_offset) if days_offset > 0 else random.randint(0, 30)
        published_at = datetime.utcnow() - timedelta(days=days_ago)
        
        # ×¦×•×¨ ××××¨ ×—×“×©
        article = Article(
            title=article_data["title"],
            summary=article_data["summary"],
            content=article_data["content"],
            url=article_data["url"],
            source=article_data["source"],
            category=article_data["category"],
            image_url=article_data["image_url"],
            thumb_url=article_data["thumb_url"],
            published_at=published_at
        )
        
        db.add(article)
        added_count += 1
        print(f"âœ… × ×•×¡×£: {article_data['title'][:60]}...")
    
    db.commit()
    return added_count


def main():
    """×¤×•× ×§×¦×™×” ×¨××©×™×ª"""
    print("=" * 70)
    print("ğŸš€ ×”×•×¡×¤×ª ××××¨×™× ×œ××¢×¨×›×ª")
    print("=" * 70)
    
    db = SessionLocal()
    
    try:
        # ×”×•×¡×£ ××××¨×™× ×œ×“×•×’××”
        count = add_sample_articles(db, days_offset=60)
        
        print("\n" + "=" * 70)
        print(f"âœ… ×”×¡×ª×™×™× ×‘×”×¦×œ×—×”! × ×•×¡×¤×• {count} ××××¨×™× ×—×“×©×™×")
        print("=" * 70)
        
        # ×”×¦×’ ×¡×˜×˜×™×¡×˜×™×§×”
        total = db.query(Article).count()
        print(f"\nğŸ“Š ×¡×”\"×› ××××¨×™× ×‘××¢×¨×›×ª: {total}")
        
        # ×”×¦×’ ×§×˜×’×•×¨×™×•×ª
        categories = db.query(Article.category).distinct().all()
        print(f"ğŸ“‚ ×§×˜×’×•×¨×™×•×ª: {', '.join([c[0] for c in categories if c[0]])}")
        
    except Exception as e:
        print(f"\nâŒ ×©×’×™××”: {e}")
        db.rollback()
    finally:
        db.close()


if __name__ == "__main__":
    main()